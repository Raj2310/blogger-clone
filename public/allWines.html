
<html lang="en">
<head>
  <meta charset="utf-8">

  <title>The HTML5 Herald</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">
  <script src="jquery.js"></script>
  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
  <![endif]-->
</head>

<body>
  <div id="container">
  </div>

  <script>

    $( document ).ready(function() {
        getDataa();
        $(document).on("click", ".editButton" , function() {
          var post_id=$($(this).parent().find(".post_id")).val();
          var content=$($(this).parent().find(".mainBody")).val();
          var title=$($(this).parent().find(".blogTitle")).html();
          var author=$($(this).parent().find(".blogAuthor")).html();
          var date=$($(this).parent().find(".blogDate")).val();
          console.log(date);
          console.log("Author:"+author);
          //console.log(post_id);
            $.ajax({
            url: 'http://127.0.0.1:3000/blogs/'+post_id,
            type: 'PUT',
            data:{
              _id:post_id,
              body:content,
              title:title,
              author:author,
              date:date
            },
            success: function(data) {
              console.log('Load was performed.');
            }
          });
        });
        $(document).on("click", ".deleteButton" , function() {
          var post_id=$($(this).parent().find(".post_id")).val();

            $.ajax({
            url: 'http://127.0.0.1:3000/blogs/'+post_id,
            type: 'DELETE',
            success: function(data) {
              console.log('Load was performed.');
            }
          });
          $(this).parent().remove();
        });


    });

    function getDataa(){

    var blogData="";
      $.get('http://127.0.0.1:3000/blogs', function(result){
       blogData=result;
       //console.log(blogData[0].name);
       var arr = blogData;
        arr.forEach(function(lang){
          $("#container").append(
              '<div class="postContainer">'+
              '<h4 class="blogTitle">'
                    +lang.title+
              '</h4><textarea rows="10" cols="50" class="mainBody">'
                    +lang.body+

              '</textarea>'
              +'<input type="hidden" class="post_id" value='+lang._id+'>'
              +'<input type="hidden" class="blogDate" value='+lang.date+'><strong class="blogAuthor">'
                    +lang.author+
              '</strong><button class="editButton" ">save</button><button class="deleteButton">delete</button></div><br>'
          );
        //  console.log(lang);
        })

     })

   }
   function editPost(event){
     console.log(event.target);
   };

  </script>
</body>
</html>
